webpackJsonp([12],{"8MtQ":function(t,e,i){e=t.exports=i("FZ+f")(!1),e.push([t.i,"\n.homework_add[data-v-c7606aca] {\n  padding: 25px 0 ;\n  text-align: center;\n}\n.homework_add span[data-v-c7606aca] {\n  display: block;\n  color: #4cc0be;\n}\n.homework_add p[data-v-c7606aca] {\n  line-height: 82px;\n  display: inline-block;\n  font-size: 100px;\n  color: #4cc0be;\n  width: 100px;\n  height: 100px;\n  border-radius: 20%;\n  border: 2px solid #4cc0be;\n  margin-bottom: 10px;\n}\n.mask[data-v-c7606aca] {\n  width: 100%;\n  height: 100%;\n  text-align: center;\n  position: fixed;\n  top: 0;\n  background: rgba(0, 0, 0, 0.8);\n  z-index: 9999;\n  overflow: hidden;\n}\n.record .time[data-v-c7606aca] {\n  margin: 3rem 0 2rem;\n  color: #fff;\n}\n.record .stop[data-v-c7606aca] {\n  width: 72px;\n  height: 72px;\n  background: url("+i("Q51K")+") center center;\n  background-size: 72px 72px;\n  margin: auto;\n  border-radius: 72px;\n}\n.record .stop[data-v-c7606aca]:active {\n  -webkit-box-shadow: 0 3px 8px rgba(0, 0, 0, 0.5) inset;\n  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.5) inset;\n}\n",""])},Euid:function(t,e,i){var a=i("8MtQ");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("rjj0")("1f36a3e0",a,!0)},Q51K:function(t,e,i){t.exports=i.p+"static/img/astop.d889b0e.png"},cDS7:function(t,e,i){"use strict";function a(t){i("Euid")}Object.defineProperty(e,"__esModule",{value:!0});var s=i("Dd8w"),o=i.n(s),n=i("ABCa"),r=i("1DHf"),c=i("rHil"),d=i("2sLL"),u=i("1sNz"),l=i("etVR"),h=i("63CM"),p=i.n(h),f=i("YxJB"),v=i("3Lt7"),m=i("NYxO"),x={name:"audio",components:{XHeader:n.a,Cell:r.a,Group:c.a,ViewBox:u.a,Checklist:l.a,XButton:d.a,Flexbox:f.a,FlexboxItem:v.a},computed:o()({},Object(m.mapGetters)(["User"]),{classList:function(){var t=[];for(var e in this.User.classes)t.push({key:this.User.classes[e].classCode,value:this.User.classes[e].name});return t}}),directives:{TransferDom:p.a},data:function(){return{classes:[],audio:{state:!1,path:"",file:""},isRecord:{state:!1,time:0,count:""}}},methods:o()({},Object(m.mapActions)(["setHomeworkAudio"]),{_play:function(){var t=this;this.audio.state?(this.audio.file.stop(),this.audio.state=!1):(this.audio.file=plus.audio.createPlayer(this.audio.path),this.audio.state=!0,this.audio.file.play(function(){t.audio.state=!1,t.audio.file.stop()},function(e){alert('播放音频文件"'+t.audio.path+'"失败：'+e.message)}))},_reset:function(){this.audio.state&&(this.audio.file.stop(),this.audio.state=!1),this.audio.path=""},_record:function(){var t=this;this.isRecord.state=!0,this.isRecord.count=setInterval(function(){120===++t.isRecord.time&&t._stop()},1e3),this.vedio.record({format:"amr",filename:"_doc/audio/"},function(e){t.audio.path=e},function(t){alert("Audio record failed: "+t.message)})},_stop:function(){this.isRecord.state=!1,this.isRecord.time=0,clearInterval(this.isRecord.count),this.vedio.stop()},_publish:function(){var t=this;this.audio.state&&(this.audio.file.stop(),this.audio.state=!1),0===this.audio.path.length?this.$vux.toast.show({text:"语音消息不能为空",type:"text",time:1e3,position:"bottom"}):0===this.classes.length?this.$vux.toast.show({text:"班级不能为空",type:"text",time:1e3,position:"bottom"}):this.setHomeworkAudio({audio:this.audio.path,classes:this.classes}).then(function(){t.classes=[],t.audio.state=!1,t.audio.path=""}).then(function(){t.$vux.toast.show({text:"发送成功",type:"text",time:700,position:"bottom",onHide:function(){history.go(-1)}})})}}),created:function(){try{this.vedio=plus.audio.getRecorder()}catch(t){console.log(t)}},beforeRouteEnter:function(t,e,i){i(function(t){})},beforeRouteLeave:function(t,e,i){if(this.audio.state&&(this.audio.file.stop(),this.audio.state=!1,i(!1)),this.audio.path||this.classes.length){var a=this;this.$vux.confirm.show({title:"确定放弃编辑的消息么？",dialogTransition:"",onCancel:function(){i(!1)},onConfirm:function(){a.classes=[],a.audio.state=!1,a.audio.path="",i()}})}else i()}},b=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view-box",{ref:"homework",attrs:{"body-padding-top":"46px"}},[i("div",{staticStyle:{width:"100%",position:"absolute",left:"0",top:"0","z-index":"1"},attrs:{slot:"header"},slot:"header"},[i("x-header",{attrs:{"left-options":{backText:"语音作业",showBack:!0}}},[i("div",{staticStyle:{margin:"0"},attrs:{slot:"right"},on:{click:t._publish},slot:"right"},[t._v("确定")])])],1),t._v(" "),i("div",[i("flexbox",{staticStyle:{margin:"1rem 0"},attrs:{gutter:0,wrap:"wrap",justify:"center"}},[i("flexbox-item",{attrs:{span:11}},[t.audio.path.length?[i("x-button",{attrs:{type:"primary"},nativeOn:{click:function(e){t._play()}}},[t._v(t._s(t.audio.state?"暂停":"播放")+"录音")]),t._v(" "),i("x-button",{attrs:{type:"warn"},nativeOn:{click:function(e){t._reset()}}},[t._v("清空录音")])]:i("x-button",{attrs:{type:"primary"},nativeOn:{click:function(e){t._record()}}},[t._v("点我录音")])],2)],1),t._v(" "),i("checklist",{attrs:{title:"选择消息发送班级","label-position":"right",required:"",options:t.classList},model:{value:t.classes,callback:function(e){t.classes=e},expression:"classes"}})],1),t._v(" "),i("div",{directives:[{name:"transfer-dom",rawName:"v-transfer-dom"},{name:"show",rawName:"v-show",value:t.isRecord.state,expression:"isRecord.state"}],staticClass:"mask record"},[i("div",{staticClass:"time"},[t._v("录音中 "+t._s(t.isRecord.time)+" 秒"),i("br"),t._v("(最长不超过120秒)")]),t._v(" "),i("div",{staticClass:"stop",on:{click:function(e){t._stop()}}})])])},g=[],_={render:b,staticRenderFns:g},w=_,k=i("VU/8"),y=a,R=k(x,w,!1,y,"data-v-c7606aca",null);e.default=R.exports}});