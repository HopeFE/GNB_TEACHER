<template>
<div class='inviteIndex  vux-scroller-header-box'>
	<div style="height:46px;">
		<x-header :left-options="{showBack: true}" style="position:fixed;left:0;top:0;width:100%;" class="vux-scroller-header">邀请好友<a slot="right" v-touch:tap="_friend">受邀好友</a></x-header>
	</div>
	<img src="../../../assets/user/friend_title.png" class="title" />
	<section class="step">
		<article>
			<h3>提示</h3>
			<p>被邀请的好友需安装归纳本APP，且被邀请好友必须是新用户哦！</p>
			<p>请好友在本界面填写您的邀请码，您再次登录归纳本APP即可获得500积分。</p>
		</article>
	</section>
	<section class="copyCode">
		<h3>我的邀请码</h3>
		<b>{{fetchInviteCode}}</b>
	</section>
	<div class="button">
		<x-button type="primary" v-show="fetchInviteCode" v-touch:tap="_shareCode(fetchInviteCode)">复制邀请码</x-button>
		<x-button type="primary" v-touch:tap="_inputCode">输入邀请码</x-button>
	</div>
</div>
</template>

<script>
import {
	XHeader,
	XInput,
	Group,
	XButton
} from 'vux'
import './invite.less'
import { getInviteCode } from '../../actions.js'
import {fetchToken,fetchInviteCode} from '../../getters'
import * as _  from '../../../config/whole.js'

export default {
	components: {
		XHeader,
		XInput,
		Group,
		XButton
	},
	vuex:{
		actions:{
			getInviteCode
		},
		getters:{
			fetchToken,
			fetchInviteCode
		}
	},
	ready(){
		this.getInviteCode({token:this.fetchToken})
	},
	methods: {
		_friend() {
			this.$router.go('friend');
		},
		_inputCode() {
			this.$router.go('input');
		},
		_shareCode(id) {
			var Context = plus.android.importClass("android.content.Context");
            var main = plus.android.runtimeMainActivity();
            var clip = main.getSystemService(Context.CLIPBOARD_SERVICE);
            plus.android.invoke(clip,"setText",id);
            _.toast('复制成功')
		}
	}
}
</script>
